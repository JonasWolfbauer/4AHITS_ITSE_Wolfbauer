| Kategorie | Beschreibung |
| --------- | --------- |
| Name      | Jonas Wolfbauer |
| Klasse    | 4AHITS |
| Fach      | ITSE |
| Thema     | Port probing und scanning |
| Datum     | 10.11.2025 bis 24.11.2025 |

# Port probing und scanning

## ``telnet``-Probe
Um zu testen ob auf Metasploitable ein SSH Server läuft, wurde ``telnet`` verwendet. ``telnet`` ist ein Tool, das mit sehr vielen Protokollen kommunizieren kann (auch Webservern!).

> **Notiz**   
Metasploitable 2 - ``192.168.2.52/24``

```bash
┌──(root㉿kali)-[~/Documents]
└─# telnet 192.168.2.52 22
Trying 192.168.2.52...
Connected to 192.168.2.52.
Escape character is '^]'.
SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1

Protocol mismatch.
Connection closed by foreign host.
```
Es ist erkenntlich - auf Metasploitable begrüßt einen mit einem ``SSH`` Server! Dies ist erkenntlich durch die Information die ausgegeben wird. Zum Testen wurde der Standard ``SSH`` Port verwendet - mit Erfolg!

## Web Server

### ``telnet``
Zu aller erst wird durch ``telnet`` versucht auf jegliche Informationen eines Webservers zuzugreifen.  
Dafür wurde der Standard ``HTTP`` Port ``80`` verwendet.

Nachdem ``telnet`` eine Verbindung aufgebaut hat (nicht erschrecken - es erscheint kein Ausgabefenster sowie auch keine Prompt) wird eine ``GET`` Request gesendet.

```bash
GET  /  HTTP/1.1
Host: 192.168.52.2
```

Daraufhin erhält man folgenden Output:

```bash
┌──(root㉿kali)-[~]
└─# telnet 192.168.2.52 80
Trying 192.168.2.52...
Connected to 192.168.2.52.
Escape character is '^]'.
GET  /  HTTP/1.1
Host: 192.168.52.2

HTTP/1.1 200 OK
Date: Mon, 10 Nov 2025 12:15:25 GMT
Server: Apache/2.2.8 (Ubuntu) DAV/2
X-Powered-By: PHP/5.2.4-2ubuntu5.10
Content-Length: 891
Content-Type: text/html

<html><head><title>Metasploitable2 - Linux</title></head><body>
<pre>

                _                  _       _ _        _     _      ____
 _ __ ___   ___| |_ __ _ ___ _ __ | | ___ (_) |_ __ _| |__ | | ___|___ \
| '_ ` _ \ / _ \ __/ _` / __| '_ \| |/ _ \| | __/ _` | '_ \| |/ _ \ __) |
| | | | | |  __/ || (_| \__ \ |_) | | (_) | | || (_| | |_) | |  __// __/
|_| |_| |_|\___|\__\__,_|___/ .__/|_|\___/|_|\__\__,_|_.__/|_|\___|_____|
                            |_|


Warning: Never expose this VM to an untrusted network!

Contact: msfdev[at]metasploit.com

Login with msfadmin/msfadmin to get started


</pre>
<ul>
<li><a href="/twiki/">TWiki</a></li>
<li><a href="/phpMyAdmin/">phpMyAdmin</a></li>
<li><a href="/mutillidae/">Mutillidae</a></li>
<li><a href="/dvwa/">DVWA</a></li>
<li><a href="/dav/">WebDAV</a></li>
</ul>
</body>
</html>

^C
Connection closed by foreign host.
```

### ``netcat`` / ``nc``
Dieselben Schritte wurden nun für ``netcat`` verwendet, und derselbe Output wurde erziehlt.


```bash
┌──(root㉿kali)-[~]
└─# nc 192.168.2.52 80
GET  /  HTTP/1.1
Host: 192.168.2.52

HTTP/1.1 200 OK
Date: Mon, 10 Nov 2025 12:13:04 GMT
Server: Apache/2.2.8 (Ubuntu) DAV/2
X-Powered-By: PHP/5.2.4-2ubuntu5.10
Content-Length: 891
Content-Type: text/html

<html><head><title>Metasploitable2 - Linux</title></head><body>
<pre>

                _                  _       _ _        _     _      ____
 _ __ ___   ___| |_ __ _ ___ _ __ | | ___ (_) |_ __ _| |__ | | ___|___ \
| '_ ` _ \ / _ \ __/ _` / __| '_ \| |/ _ \| | __/ _` | '_ \| |/ _ \ __) |
| | | | | |  __/ || (_| \__ \ |_) | | (_) | | || (_| | |_) | |  __// __/
|_| |_| |_|\___|\__\__,_|___/ .__/|_|\___/|_|\__\__,_|_.__/|_|\___|_____|
                            |_|


Warning: Never expose this VM to an untrusted network!

Contact: msfdev[at]metasploit.com

Login with msfadmin/msfadmin to get started


</pre>
<ul>
<li><a href="/twiki/">TWiki</a></li>
<li><a href="/phpMyAdmin/">phpMyAdmin</a></li>
<li><a href="/mutillidae/">Mutillidae</a></li>
<li><a href="/dvwa/">DVWA</a></li>
<li><a href="/dav/">WebDAV</a></li>
</ul>
</body>
</html>

^C
```

### ``curl``
Mit ``curl`` konnte ich ein anderer, kompakterer Output erzielt werden.

```bash
┌──(root㉿kali)-[~]
└─# curl 192.168.2.52/echo
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>404 Not Found</title>
</head><body>
<h1>Not Found</h1>
<p>The requested URL /echo was not found on this server.</p>
<hr>
<address>Apache/2.2.8 (Ubuntu) DAV/2 Server at 192.168.2.52 Port 80</address>
</body></html>
```

### Hilfreiche Quellen
- [Thomas Krenn / TCP Port 80 (http) Zugriff mit telnet überprüfen](https://www.thomas-krenn.com/de/wiki/TCP_Port_80_(http)_Zugriff_mit_telnet_%C3%BCberpr%C3%BCfen)
- [ReqBin / How do I send a GET request using Curl?](https://reqbin.com/req/c-1n4ljxb9/curl-get-request-example)

# ``netcat`` Port Scan
Ziel der Übung ist es, alle offenen Ports eines Zielhosts (in diesem Fall einer metasploitable VM) zu ermitteln.  
Das dafür zu verwendende Tool ist ``netcat`` oder auch kurz ``nc``.

## Command
Das Grundgerüst des Commands sieht wiefolgt aus:
```bash
netcat -z -v { Hostname / IP } { Port-Range }
```

Daraus ergibt sich folgender Command:

```bash
netcat -z -v 192.168.2.52 1-30
```

Der Aufbau des Commands ist relativ simpel.
- ``-z``  
Ist die Option für Port Scanning
- ``-v``  
"verbose" ... ausführlicher Output

## Output
Dieser Command liefert für den Metasploitable-Scan folgenden Output:
```bash
┌──(root㉿kali)-[~]
└─# netcat -z -v 192.168.2.52 1-30
192.168.2.52: inverse host lookup failed: Unknown host
(UNKNOWN) [192.168.2.52] 25 (smtp) open
(UNKNOWN) [192.168.2.52] 23 (telnet) open
(UNKNOWN) [192.168.2.52] 22 (ssh) open
(UNKNOWN) [192.168.2.52] 21 (ftp) open
```

Es wird ersichtlich, dass viele Basic Services wie ``SSH`` oder ``FTP`` für Fileserver ihre Ports offen haben. Weiters gibt es noch eine kleine Beschreibung zu jedem Service. (Portnummer aufsteigend)

- ``FTP`` 
... **F**ile **T**ransfer **P**rotocol ist ein Protokoll für Übertragen von Dateiübertragung über das Internet.  
Standard Port: ``21``
- ``SSH``  
... **S**ecure **Sh**ell ist ein sicheres verschlüsseltes Protokoll für Remote Connections.  
Standard Port: ``22``
- ``TELNET``  
... **Tel**etype **Net**work ist der Vorgänger von ``SSH`` und wurde ebenfalls für Remote Connections verwendet. ``telnet`` verwendet keine Verschlüsselungen und überträgt Inhalt als Plaintext.  
Standard Port: ``23``
- ``SMTP``  
... **S**imple **M**ail **T**ransfer **P**rotocol ist ein Protokoll, welches für den Versand für E-Mails verwendet wird.  
Standard Port: ``25`` (für Kommunikation zwischen Mailservern)
Standard Port: ``587``, ``465`` (für sichere E-Mail Übertragung)

### Hilfreiche Quellen
- [Linux and Unix Port Scanning With netcat [nc] Command](https://www.cyberciti.biz/faq/linux-port-scanning/)

# ``nmap`` Port Scan
Die Übung ``nmap`` Port Scan ziehlt darauf alle offenen Ports eines Hosts ausfindig zu machen und eine Liste an offenen Ports zu erhalten.

## metasploitable Port Scan
Nach ``netcat`` wird mittels ``nmap`` wird metasploitable nach offenen Ports gescannt.

### Command (Scannen aller möglichen Ports)
Jene Outputs wurden mit folgendem Command erziehlt:
```bash
nmap 192.168.1.54 -p-
```

- ``-p``  
Kann verwendet werden um eine Port Range anzugeben.
- ``-p-``  
Scannt alle Ports von ``1`` bis ``65535``. 

>**Hinweis**  
Von nun an in der Übung wird eine andere IP-Range verwendet. Dies liegt an einem Sitzplatzwechsel. Die Übungen wurden nicht in irgendeiner Art negativ beeinflusst.

### Output (Alles möglichen Ports)
Der Output liefert eine große Liste an offenen Ports, welche auf der metasploitable geöffnet sind.

```bash
┌──(root㉿kali)-[~/Documents]
└─# nmap 192.168.1.54 -p-
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-24 06:28 EST
Nmap scan report for 192.168.1.54
Host is up (0.0024s latency).
Not shown: 65505 closed tcp ports (reset)
PORT      STATE SERVICE
21/tcp    open  ftp
22/tcp    open  ssh
23/tcp    open  telnet
25/tcp    open  smtp
53/tcp    open  domain
80/tcp    open  http
111/tcp   open  rpcbind
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
512/tcp   open  exec
513/tcp   open  login
514/tcp   open  shell
1099/tcp  open  rmiregistry
1524/tcp  open  ingreslock
2049/tcp  open  nfs
2121/tcp  open  ccproxy-ftp
3306/tcp  open  mysql
3632/tcp  open  distccd
5432/tcp  open  postgresql
5900/tcp  open  vnc
6000/tcp  open  X11
6667/tcp  open  irc
6697/tcp  open  ircs-u
8009/tcp  open  ajp13
8180/tcp  open  unknown
8787/tcp  open  msgsrvr
35492/tcp open  unknown
47335/tcp open  unknown
59844/tcp open  unknown
60608/tcp open  unknown
MAC Address: 00:0C:29:09:3C:B1 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 7.67 seconds                                                             
```

Setzt man dies mit gleich mit dem default Scan, so ist ersichtlich, dass der default Scan nicht alle Ports scannt!  
Eine Auflistung der Ports, welche der Default Scan nicht gefunden hat.

| Ports / Protocol | Service |
| --------- | --------- |
|``3632/tcp``|``distccd``|
|``6697/tcp``|``ircs-u``|
|``8787/tcp``|``msgsrvr``|
|``35492/tcp``|``unknown``|
|``47335/tcp``|``unknown``|
|``59844/tcp``|``unknown``|
|``60608/tcp``|``unknown``|

### Optionen
- ``-pn``  
... **N**o **P**ing  
Diese Option wird verwendet um einen Ping Scan zu überspringen und direkt mit Port Scans anzufangen.  
Diese Option kann durchaus sinnvoll sein - standardmäßig führt ``nmap`` einen Ping Test durch, und nimmt bei fehlschlagen den Host als offline wahr. Dies kann man jedoch umgehen indem man einen Ping Scan überspringt - ``nmap`` nimmt an, dass der Host online ist.
- ``-sV``  
Aktiviert "Version Detection" und ermittelt die Services hinter den Ports (standard und non-standard Ports).
- ``-O``  
Aktiviert das OS-Scanning und ermittelt das Betriebssystem des Hosts.
- ``-A``  
Ein aggressiver Scan liefert mehr Informationen als bei einem standard Scan, aber ist wahrscheinlicher entdeckt zu werden.  
*"Aggressive scans send out more probes than a regular scan, and are more likely to be detected during a security audit."*
- ``-T paranoid|sneaky|polite|normal|aggressive|insane``  
``nmap`` bietet Möglichkeiten verschiedenste Timing Parameter zu setzen. Es gibt jedoch auch Templates, welche von kurzen Zeiten (wie ``paranoid``) bis zu längeren Zeiten (wie ``insane``) Test durchführen.
- ``-oN``  
Schreibt den Output in eine Datei, sodass dieser für andere Tools oder Personen weiterverwendet werden kann.
- ``--reason``  
... ist eine mächtige Option, welche ermitteln kann, warum ein bestimmter Port sich in seinem  ``OPEN``, ``CLOSED`` oder ``Filtered`` Status befindet.
- ``--top-ports <n>``  
Scannt die in dem ``nmap-services`` File nach Popularität, basierend auf dem "open-frequency"-Values ``n`` Ports.

### Weitere Port Scans
Port Scans werden auf verschiedenen Geräten ausgeführt.

#### Windows Port Scan
Windows ist bekannt dafür eine etwas strengere Firewall zu haben, so werden auch oft ``ICMP`` blockiert.

```bash
┌──(root㉿kali)-[~]
└─# nmap 192.168.1.51 -p-
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-24 07:09 EST
Nmap scan report for 192.168.1.51
Host is up (0.00097s latency).
Not shown: 65531 filtered tcp ports (no-response)
PORT      STATE SERVICE
135/tcp   open  msrpc
2179/tcp  open  vmrdp
7680/tcp  open  pando-pub
27036/tcp open  unknown
MAC Address: D8:E2:DF:FB:B0:49 (Microsoft)

Nmap done: 1 IP address (1 host up) scanned in 105.15 seconds
```

Der Output zeigt, gegenüber einem als vulnerablen designten System (metasploitable) sind auf Windows viele bekannte Services nicht auffindbar. Jedoch einige mir unbekannte Services haben offene TCP Ports.

#### Kali Port Scan
Mittels kali führe ich einen Port Scan auf sich selbst durch.

```bash
┌──(root㉿kali)-[~]
└─# nmap 192.168.1.53 -p-
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-24 07:15 EST
Nmap scan report for 192.168.1.53
Host is up (0.0000030s latency).
Not shown: 65534 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh

Nmap done: 1 IP address (1 host up) scanned in 0.75 seconds
```

Erstaunlicherweise hat kali Linux selbst nur einen Port offen, und das ist der ``SSH``-Server, den ich für meine Zwecke verwende.  
Dies ist macht nach etwas längerem Nachdenken auch Sinn - Kali ein OS, welches auch aktiv in der Cybersecurity Branche verwendet wird, sollte bei unbefugten Host Discoveries etc. innerhalb eines Netzwerkes sicher und versteckt sein.

### ``nmap``-Cheatsheat
Zum Schluss habe ich ein Cheatsheat erstellt, wessen Commands ich meines Erachtens sinnvoll finde und auch verwendet habe.

| Option | Beschreibung |
| --------- | --------- |
|``-p-``| Scannt alle Ports |
|``-pn``| Scannen aller Ports ohne Ping Probe |
|``-T insane``| Sehr gründliche tiefe Suche |
|``-oN``| Speichern des Outputs in ein Textfile |

### Hilfreiche Quellen
- [Service and Version Detection | Nmap Network Scanning](https://nmap.org/book/man-version-detection.html)
- [OS Detection | Nmap Network Scanning](https://nmap.org/book/man-os-detection.html)
- [Cybersecurity Aggressive Scan - Nmap](https://www.codecademy.com/resources/docs/cybersecurity/nmap/aggressive-scan)
- [Timing and Performance | Nmap Network Scanning](https://nmap.org/book/man-performance.html)
- [How to save Nmap output to file Example a Complete Guide](https://cyberxed.medium.com/how-to-save-nmap-output-to-file-example-a-complete-guide-491fff586dfe)
- [How to use the --reason option in Nmap to bypass firewalls](https://labex.io/tutorials/nmap-how-to-use-the-reason-option-in-nmap-to-bypass-firewalls-415548)
- [Port Specification and Scan Order](https://nmap.org/book/man-port-specification.html)